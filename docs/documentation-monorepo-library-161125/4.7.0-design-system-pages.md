# 4.7.0 Design System: Pages

**Version:** 1.0
**Date:** 2025-11-04
**Status:** Active
**Content Type:** implementation
**Category:** design-system

---

# Pages: Templates & Layouts

**Purpose:** Documentation of page-level templates, layouts, and routing patterns in the kolkrabbi design system.

> Pages represent the highest level of abstraction in our atomic design methodology. They orchestrate organisms, molecules, and atoms into complete, functional user interfaces. Pages define the structural layout, routing logic, and content management patterns that guide how users navigate and interact with the application.

## Design Philosophy

1. **Template-Driven** - Pages use reusable templates for consistency across similar views
2. **Content-Agnostic** - Templates separate structure from content via CMS integration
3. **Responsive-First** - All page layouts adapt seamlessly across device sizes
4. **SEO-Optimized** - Pages implement semantic markup and meta data patterns
5. **Performance-Conscious** - Optimized loading strategies for fast initial render
6. **Accessible** - WCAG 2.1 AA compliance for all page templates

## Page Architecture

### Layer Hierarchy

Pages operate at the highest level of the design system hierarchy:

```
Pages (4.x.x)
  └─ Organisms (3.x.x)
      └─ Molecules (3.x.x)
          └─ Atoms (3.1.x)
```

### Template Composition

Each page template follows a consistent structure:

```tsx
// Page Template Structure
<PageTemplate>
  <Header />                          {/* Organism */}
    <NavigationMenu />                {/* Molecule */}
      <SidebarMenuItem />             {/* Atom */}
    <UserMenu />
  <Sidebar>                           {/* Organism */}
    <NavigationMenu />
  <Main>
    <ContentSection>                  {/* Organism */}
      <Card />                        {/* Molecule */}
        <Badge />                     {/* Atom */}
    </ContentSection>
  </Main>
  <Footer />                          {/* Organism */}
</PageTemplate>
```

## Page Categories

### Layout Templates

#### BaseLayout

**Location:** `apps/web/src/components/layout/`

The foundation layout that wraps all page content with consistent structure.

**Components:**
- Global navigation (Header/Sidebar)
- Main content area
- Global notifications
- Footer

**Props:**
```tsx
interface BaseLayoutProps {
  children: React.ReactNode
  sidebar?: React.ReactNode
  header?: React.ReactNode
  footer?: React.ReactNode
  maxWidth?: 'sm' | 'md' | 'lg' | 'xl' | 'full'
  padding?: 'none' | 'sm' | 'md' | 'lg'
}
```

**Usage:**
```tsx
<BaseLayout maxWidth="lg" padding="md">
  <PageContent />
</BaseLayout>
```

#### DocumentLayout

**Location:** `apps/web/src/components/layout/`

Layout optimized for document viewing (articles, blog posts, documentation).

**Features:**
- Optimal reading width (65ch)
- Typography-focused styles
- Progressive disclosure patterns
- Article meta data display

**Props:**
```tsx
interface DocumentLayoutProps {
  title: string
  description?: string
  publishDate?: string
  author?: string
  tags?: string[]
  readingTime?: string
  children: React.ReactNode
}
```

**Usage:**
```tsx
<DocumentLayout
  title="Design System Evolution"
  description="Building a scalable component library"
  publishDate="2025-11-04"
  readingTime="12 min read"
>
  <ProseBlock>
    {/* Rich text content */}
  </ProseBlock>
</DocumentLayout>
```

### Content Page Templates

#### HomePage

**Location:** `apps/web/src/routes/`

Marketing/homepage template showcasing product or service.

**Organisms Used:**
- HomeHero (3.3.x)
- FeatureGrid (3.3.x)
- TestimonialCarousel (3.3.x)
- CTASection (3.3.x)

**Content Sections:**
```tsx
<BaseLayout>
  <HomeHero />
  <FeatureGrid />
  <ValueProposition />
  <TestimonialCarousel />
  <CTASection />
</BaseLayout>
```

**CMS Integration:**
```tsx
// Sanity schema example
export default {
  name: 'homePage',
  title: 'Home Page',
  type: 'document',
  fields: [
    { name: 'hero', type: 'hero' },
    { name: 'features', type: 'array', of: [{ type: 'feature' }] },
    { name: 'testimonials', type: 'array', of: [{ type: 'testimonial' }] }
  ]
}
```

#### WorkPage

**Location:** `apps/web/src/routes/work/`

Portfolio/work showcase page with filtering and grid layout.

**Features:**
- Project filtering by category
- Responsive grid layout
- Lazy loading for performance
- SEO-optimized project listings

**Organisms Used:**
- ProjectGrid (3.3.x)
- FilterBar (3.3.x)
- Pagination (3.3.x)

**Props:**
```tsx
interface WorkPageProps {
  projects: Project[]
  categories: Category[]
  activeCategory?: string
  pagination?: PaginationProps
}
```

#### ProjectDetailPage

**Location:** `apps/web/src/routes/work/[slug]/`

Detailed view for individual projects with media galleries.

**Sections:**
- Hero with project meta
- Image gallery carousel
- Project description (ProseBlock)
- Technical details
- Related projects

**Organisms Used:**
- ProjectHero (3.3.x)
- MediaGallery (3.3.x)
- ProseBlock (3.3.x)
- TechStack (3.3.x)
- RelatedProjects (3.3.x)

**URL Structure:**
```
/work/project-slug
  ├── /work/project-slug#overview
  ├── /work/project-slug#gallery
  └── /work/project-slug#details
```

### Application Page Templates

#### DashboardPage

**Location:** `apps/web/src/routes/dashboard/`

Application dashboard with data visualization and quick actions.

**Layout:**
- Sidebar navigation
- Top header with user menu
- Main content with widgets/cards
- Status indicators and alerts

**Organisms Used:**
- DashboardSidebar (3.3.x)
- DashboardHeader (3.3.x)
- WidgetGrid (3.3.x)
- StatusAlert (3.3.x)

#### SettingsPage

**Location:** `apps/web/src/routes/settings/`

User settings and preferences with form validation.

**Sections:**
- Settings navigation
- Form sections with validation
- Save/Cancel actions
- Confirmation dialogs

**Organisms Used:**
- SettingsNav (3.3.x)
- FormSection (3.3.x)
- ActionButtons (3.3.x)
- ConfirmationDialog (3.3.x)

## Routing & Navigation

### Route Structure

```
/                           → HomePage
/work                       → WorkPage
/work/[slug]               → ProjectDetailPage
/blog                      → BlogListing
/blog/[slug]               → BlogPostPage
/dashboard                 → DashboardPage
/dashboard/settings        → SettingsPage
/about                     → StaticPage
/contact                   → ContactPage
```

### Nested Routing

```tsx
// Example: Project detail routes
const projectRoutes = [
  {
    path: '/work',
    element: <WorkPage />,
    children: [
      {
        path: ':slug',
        element: <ProjectDetailPage />,
        children: [
          { path: 'gallery', element: <ProjectGallery /> },
          { path: 'details', element: <ProjectDetails /> }
        ]
      }
    ]
  }
]
```

### Navigation Patterns

#### Breadcrumbs

```tsx
// Breadcrumb navigation
<Breadcrumbs>
  <BreadcrumbItem href="/work">Work</BreadcrumbItem>
  <BreadcrumbItem href="/work/project-slug">Project Name</BreadcrumbItem>
  <BreadcrumbItem current>Gallery</BreadcrumbItem>
</Breadcrumbs>
```

#### Pagination

```tsx
// Pagination for listings
<Pagination
  currentPage={currentPage}
  totalPages={totalPages}
  onPageChange={handlePageChange}
/>
```

## Responsive Design

### Breakpoint Strategy

| Breakpoint | Width | Usage |
|------------|-------|-------|
| sm | 640px | Mobile portrait |
| md | 768px | Mobile landscape |
| lg | 1024px | Tablet portrait |
| xl | 1280px | Desktop |
| 2xl | 1536px | Large desktop |

### Layout Patterns

#### Stack Layout (Mobile)

```tsx
<div className="stack-layout">
  <Header />
  <Sidebar />
  <Main />
  <Footer />
</div>
```

#### Split Layout (Tablet+)

```tsx
<div className="split-layout">
  <Header />
  <div className="content-split">
    <Sidebar />
    <Main />
  </div>
</div>
```

#### Grid Layout (Desktop)

```tsx
<div className="grid-layout">
  <Header />
  <div className="content-grid">
    <Sidebar width="20%" />
    <Main width="60%" />
    <Aside width="20%" />
  </div>
</div>
```

## Content Management

### CMS Integration (Sanity)

#### Document Schemas

```tsx
// Sanity schema for pages
export default {
  name: 'page',
  title: 'Page',
  type: 'document',
  fields: [
    {
      name: 'title',
      type: 'string',
      validation: (Rule) => Rule.required()
    },
    {
      name: 'slug',
      type: 'slug',
      options: {
        source: 'title',
        maxLength: 96
      }
    },
    {
      name: 'content',
      type: 'array',
      of: [{ type: 'block' }]
    },
    {
      name: 'seo',
      type: 'seo'
    }
  ]
}
```

#### Content Fetching

```tsx
// GROQ queries for pages
const PAGE_QUERY = `*[_type == "page" && slug.current == $slug][0]{
  title,
  content,
  seo
}`

const WORK_QUERY = `*[_type == "project"] | order(_createdAt desc) {
  title,
  slug,
  category,
  thumbnail,
  excerpt
}`
```

### Static Site Generation

```tsx
// Next.js SSG example
export async function getStaticPaths() {
  const projects = await client.fetch(PROJECT_SLUGS_QUERY)

  return {
    paths: projects.map((project) => ({
      params: { slug: project.slug.current }
    })),
    fallback: false
  }
}

export async function getStaticProps({ params }) {
  const project = await client.fetch(PROJECT_QUERY, {
    slug: params.slug
  })

  return {
    props: {
      project
    }
  }
}
```

## Performance Optimization

### Loading Strategies

#### Progressive Loading

```tsx
// Load critical content first
<BaseLayout>
  <Header />                          {/* Critical - inline */}
  <Main>
    <Hero />                          {/* Critical - inline */}
    <LazyLoad>
      <FeatureGrid />                 {/* Deferred */}
    </LazyLoad>
  </Main>
</BaseLayout>
```

#### Code Splitting

```tsx
// Lazy load page sections
const ProjectGallery = lazy(() => import('./ProjectGallery'))
const TechStack = lazy(() => import('./TechStack'))

function ProjectDetailPage() {
  return (
    <ProjectHero />
    <Suspense fallback={<GallerySkeleton />}>
      <ProjectGallery />
    </Suspense>
    <Suspense fallback={<TechStackSkeleton />}>
      <TechStack />
    </Suspense>
  )
}
```

#### Image Optimization

```tsx
// Next.js Image component
<Image
  src={project.thumbnail}
  alt={project.title}
  width={800}
  height={600}
  priority={isPriority}
/>
```

## SEO Implementation

### Meta Tags

```tsx
// Dynamic meta tags
export async function generateMetadata({ params }) {
  const project = await client.fetch(PROJECT_QUERY, {
    slug: params.slug
  })

  return {
    title: project.title,
    description: project.description,
    openGraph: {
      title: project.title,
      description: project.description,
      images: [project.thumbnail]
    },
    twitter: {
      card: 'summary_large_image',
      title: project.title,
      description: project.description
    }
  }
}
```

### Structured Data

```tsx
// JSON-LD for rich snippets
const projectSchema = {
  '@context': 'https://schema.org',
  '@type': 'CreativeWork',
  name: project.title,
  description: project.description,
  image: project.thumbnail,
  url: `/work/${project.slug}`
}
```

## Accessibility Standards

### Page Structure

```tsx
// Semantic HTML structure
<main role="main" aria-label="Main content">
  <article aria-labelledby="page-title">
    <header>
      <h1 id="page-title">{title}</h1>
    </header>
    <section aria-label="Content">
      {children}
    </section>
  </article>
</main>
```

### Skip Links

```tsx
// Skip to content link
<a href="#main-content" className="skip-link">
  Skip to main content
</a>

<main id="main-content">
  {/* Page content */}
</main>
```

### Focus Management

```tsx
// Focus handling for dynamic content
function Page({ children }) {
  useEffect(() => {
    // Set initial focus on page load
    const main = document.querySelector('[role="main"]')
    main?.focus()
  }, [])

  return (
    <div>
      {children}
    </div>
  )
}
```

## Error Handling

### 404 Pages

```tsx
// Custom 404 template
export default function NotFound() {
  return (
    <BaseLayout>
      <NotFoundHero />
      <SearchForm />
      <RecentProjects />
    </BaseLayout>
  )
}
```

### Error Boundaries

```tsx
// React Error Boundary for page sections
class PageErrorBoundary extends Component {
  constructor(props) {
    super(props)
    this.state = { hasError: false }
  }

  static getDerivedStateFromError(error) {
    return { hasError: true }
  }

  componentDidCatch(error, errorInfo) {
    console.error('Page error:', error, errorInfo)
  }

  render() {
    if (this.state.hasError) {
      return (
        <ErrorFallback
          title="Something went wrong"
          description="Please try again later"
          action={<Button onClick={() => window.location.reload()}>Reload</Button>}
        />
      )
    }

    return this.props.children
  }
}
```

## Analytics & Tracking

### Page View Tracking

```tsx
// Track page views
function usePageTracking(path: string, title: string) {
  useEffect(() => {
    // Analytics tracking
    gtag('config', GA_TRACKING_ID, {
      page_path: path,
      page_title: title
    })
  }, [path, title])
}
```

### User Journey Tracking

```tsx
// Track user interactions
function trackUserAction(action: string, category: string, label?: string) {
  gtag('event', action, {
    event_category: category,
    event_label: label
  })
}
```

## Testing Strategy

### Page Testing

```tsx
// Jest test for page rendering
describe('HomePage', () => {
  it('renders all sections', () => {
    render(<HomePage />)
    expect(screen.getByRole('heading', { name: /hero/i })).toBeInTheDocument()
    expect(screen.getByTestId('feature-grid')).toBeInTheDocument()
    expect(screen.getByTestId('cta-section')).toBeInTheDocument()
  })
})
```

### Accessibility Testing

```tsx
// Axe accessibility test
import { axe, toHaveNoViolations } from 'jest-axe'

expect.extend(toHaveNoViolations)

it('has no accessibility violations', async () => {
  const { container } = render(<HomePage />)
  const results = await axe(container)
  expect(results).toHaveNoViolations()
})
```

### Performance Testing

```tsx
// Lighthouse CI test
describe('Performance', () => {
  it('meets performance budget', async () => {
    const results = await lighthouse('http://localhost:3000', {
      onlyCategories: ['performance']
    })
    expect(results.lhr.categories.performance.score).toBeGreaterThan(0.9)
  })
})
```

## Implementation Patterns

### Page Component Pattern

```tsx
// Standard page component structure
export default function PageName() {
  // Data fetching
  const data = useData()

  // State management
  const [state, setState] = useState()

  // Effects
  useEffect(() => {
    // Side effects
  }, [dependency])

  // Event handlers
  const handleAction = useCallback(() => {
    // Handle user action
  }, [])

  return (
    <BaseLayout>
      {/* Page content */}
    </BaseLayout>
  )
}
```

### Custom Hooks Pattern

```tsx
// Page-specific custom hooks
function useProject(slug: string) {
  return useQuery(['project', slug], () => fetchProject(slug))
}

function useProjectNavigation(projects: Project[]) {
  const router = useRouter()
  const currentIndex = projects.findIndex(p => p.slug === router.query.slug)

  const navigateToProject = useCallback((direction: 'prev' | 'next') => {
    const newIndex = direction === 'prev' ? currentIndex - 1 : currentIndex + 1
    if (projects[newIndex]) {
      router.push(`/work/${projects[newIndex].slug}`)
    }
  }, [currentIndex, projects, router])

  return { navigateToProject, hasPrev: currentIndex > 0, hasNext: currentIndex < projects.length - 1 }
}
```

## Best Practices

### Do's

✅ Use semantic HTML elements for structure
✅ Implement proper heading hierarchy (h1 → h2 → h3)
✅ Provide alt text for all images
✅ Use loading states for async content
✅ Implement proper error boundaries
✅ Optimize images with Next.js Image component
✅ Use TypeScript for type safety
✅ Test accessibility with automated tools
✅ Track page performance metrics
✅ Implement proper meta tags for SEO

### Don'ts

❌ Skip heading levels (h1 → h3)
❌ Use divs instead of semantic elements
❌ Load all content synchronously
❌ Forget error handling for API failures
❌ Ignore mobile-first responsive design
❌ Skip meta tag optimization
❌ Use generic page titles
❌ Forget to handle loading states
❌ Skip accessibility testing
❌ Mix layout and business logic

## Common Patterns

### Data Fetching

```tsx
// Server-side data fetching
export async function getStaticProps() {
  const projects = await client.fetch(WORK_QUERY)

  return {
    props: {
      projects
    }
  }
}

// Client-side data fetching
export default function WorkPage({ projects: initialProjects }) {
  const { data: projects } = useQuery(WORK_QUERY, {
    initialData: initialProjects
  })

  return <ProjectGrid projects={projects} />
}
```

### Form Handling

```tsx
// Contact form with validation
export default function ContactPage() {
  const [formData, setFormData] = useState(initialState)
  const [errors, setErrors] = useState({})
  const [isSubmitting, setIsSubmitting] = useState(false)

  const handleSubmit = async (e) => {
    e.preventDefault()
    const validationErrors = validateForm(formData)

    if (Object.keys(validationErrors).length > 0) {
      setErrors(validationErrors)
      return
    }

    setIsSubmitting(true)
    try {
      await submitForm(formData)
      // Show success message
    } catch (error) {
      // Show error message
    } finally {
      setIsSubmitting(false)
    }
  }

  return (
    <BaseLayout>
      <ContactForm
        data={formData}
        errors={errors}
        onSubmit={handleSubmit}
        isSubmitting={isSubmitting}
      />
    </BaseLayout>
  )
}
```

### Search Implementation

```tsx
// Search with debouncing
export default function WorkPage() {
  const [searchQuery, setSearchQuery] = useState('')
  const [filteredProjects, setFilteredProjects] = useState(projects)

  const debouncedSearch = useMemo(
    () => debounce((query: string) => {
      const filtered = projects.filter(project =>
        project.title.toLowerCase().includes(query.toLowerCase())
      )
      setFilteredProjects(filtered)
    }, 300),
    [projects]
  )

  useEffect(() => {
    debouncedSearch(searchQuery)
  }, [searchQuery, debouncedSearch])

  return (
    <BaseLayout>
      <SearchInput
        value={searchQuery}
        onChange={setSearchQuery}
        placeholder="Search projects..."
      />
      <ProjectGrid projects={filteredProjects} />
    </BaseLayout>
  )
}
```

## Migration from Legacy

### URL Structure Changes

```diff
- /portfolio                    → /work
- /portfolio/[id]              → /work/[slug]
- /blog-post/[slug]            → /blog/[slug]
- /dashboard                   → /dashboard
```

### Component Changes

```diff
- <Layout>                     → <BaseLayout>
- <PageContent>                → <Main>
- <StaticPage>                 → create custom template
```

### Data Structure Changes

```diff
- project.id                   → project.slug.current
- project.category_id          → project.category.title
- project.image_url            → project.thumbnail.asset.url
```

## Related Documentation

**Design System:**
- [3.0.0 Design System: Components Overview](3.0.0-design-system-components.md) - Atomic design methodology
- [3.3.0 Design System: Organisms](3.3.0-design-system-organisms.md) - Page-level components

**Foundation:**
- [1.0.0 Foundation: Repository Structure](1.0.0-foundation-repository-structure.md) - File organization
- [1.0.1 Foundation: Naming Conventions](1.0.1-foundation-naming-conventions.md) - Naming standards

**Research:**
- [6.1.0 Research: Data Tables](6.1.0-research-data-tables.md) - Data display patterns
- [6.2.0 Research: Typography](6.2.0-research-typography.md) - Typography in page layouts

**Content:**
- [5.0.0 Design System: Content Strategy](5.0.0-design-system-content-strategy.md) - CMS integration patterns

---

**File Locations:**
- **Templates:** `apps/web/src/components/layout/`
- **Pages:** `apps/web/src/routes/`
- **Schemas:** `apps/web/src/schemas/`
- **Styles:** `packages/ui/css/pages.css`

---

**Last Updated:** 2025-11-04
**Cross-References:** 3.0.0, 3.3.0, 1.0.0, 1.0.1, 6.1.0, 6.2.0, 5.0.0
**Category:** Design System
**Status:** Active
