# 5.2.0 Analytics System

**Version:** 5.2.0
**Status:** Active
**Last Updated:** 2025-11-12

## Overview

The Analytics system provides domain-agnostic data visualization and dashboard components. While currently populated with chess data as a reference implementation, all components are designed to be reusable for any data source (fonts, projects, metrics, etc.).

Located at `/workshop/analytics` with three main pages and two dashboard implementations.

---

## Page Structure

### 1. Analytics Overview (`/workshop/analytics/overview`)

**File:** `apps/web/src/routes/workshop/AnalyticsOverview.jsx`

**Purpose:** Dashboard selector and layout showcase

**Contents:**
- **Dashboard Selection Cards** - Two clickable cards linking to:
  - Analysis Dashboard (comprehensive performance analysis)
  - Performance Dashboard (rating progression and metrics)
- **KPI Cards Grid** - 4-column grid showing:
  - Games Played (with delta)
  - Win Rate (with percentage change)
  - Average Rating (with delta)
  - Active Opponents (with count change)
- **Main Dashboard Layout** - Large chart + sidebar stack example
- **Distribution Visualization** - Donut chart + sidebar bars example
- **Data Components Grid** - RIVALS card + meter cards (3-column)
- **Featured Analysis** - Large area chart with badge + sidebar info
- **Summary Row** - Line chart + RIVALS + meters (3-column)

**Note:** Also accessible at `/workshop/analytics/dashboards` (same content)

---

### 2. Analytics Components (`/workshop/analytics/components`)

**File:** `apps/web/src/routes/workshop/AnalyticsComponents.jsx`

**Purpose:** Comprehensive showcase of all analytics building blocks and chart types

**Contents:**

#### Chess Apparatus Components
- **Full Analysis Layout** - Complete table + board workflow (ChessAnalysisLayout)
- **Chessboard + Controls** - Desktop board viewer (760px) with sidebar controls (440px)
- **Controls Sidebar Solo** - Standalone control panel showcase
- **Game Archive Table** - Game browsing table with search/filters
- **Individual Board Sizes** - Mobile (384px), Tablet (520px), Desktop (760px) boards
- **Empty Board Templates** - Coordinate-only boards for each size

#### Analytics Chart Components (19 cards total)
1. **Alert Status Card** - Color-coded status with icon + message
2. **Win/Loss/Draw Pie Chart** - SVG 3-segment pie with stats
3. **Time Series Chart** - Dual-line wins/losses over time with interactive hover
4. **Win Rate Header** - Large metric with trending icon
5. **Donut Chart** - Time class distribution with interactive legend
6. **Stacked Bar Chart** - Horizontal bars showing game distribution
7. **Circular Gradient Chart** - Multi-ring concentric arcs (4 rings)
8. **Candlestick Chart** - Rating OHLC over time
9. **Rating Histogram** - Vertical bars in 100-point buckets
10. **Hourly Heatmap** - 7×24 grid with opacity scaling
11. **Featured Opening Card** - Dual-line area chart with stats
12. **Scatter Plot** - Opponent rating vs time with correlation line
13. **Rating Progression Line** - Multi-year ELO history
14. **RIVALS Card** - Top 5 opponents by game count
15. **Overall Ledger Meters** - Horizontal progress bars by time class
16. **Game Outcomes Donut** - Win/draw/loss distribution
17. **Top Openings Card** - 5 most-played openings with win rates
18. **Top 5 Best Wins** - Upset victories sorted by rating difference
19. **Highest ELO by Time Control** - Peak ratings with color-coded dots

**Data Source:** All components use chess data from `@kol/chess-data` package

---

### 3. Analysis Dashboard (`/workshop/analytics/dashboards/analysis`)

**File:** `apps/web/src/routes/workshop/AnalyticsDashboardAnalysis.jsx`

**Purpose:** Production-ready comprehensive analysis dashboard

**Layout:**
- **Hero Section** - ChessHero with player info, stats, title badge
- **KPI Row** - 4 metric cards (games, win rate, avg rating, opponents)
- **Main Grid** - Responsive dashboard grid with multiple card types:
  - Stacked area chart (time class distribution)
  - Column chart (monthly game volume)
  - Simple metric cards
  - Stacked bar mini cards
  - Featured analysis card
  - Progress meter cards
  - Line chart + list cards
  - Rivals cards
  - Histogram card
  - Peak ratings card
  - Compact stacked bar with win rate

**Data Integration:**
- Real data from `getManifest()`, `getMonthlySummary()`, `getGameMeta()`
- Calculations for totals, win rates, averages, trends
- Time class color coding via `timeClassLegendClass`
- Formatted outputs using `formatCompactNumber()`, `formatTimeClass()`

**Interactive Features:**
- ChessBoardWithControls integration
- Clickable metrics
- Color-coded time classes

---

### 4. Performance Dashboard (`/workshop/analytics/dashboards/performance`)

**File:** `apps/web/src/routes/workshop/AnalyticsDashboardPerformance.jsx`

**Purpose:** Rating progression and performance metrics dashboard

**Layout:**
- **Hero Section** - Player identity with stats and title
- **KPI Row** - Key metrics overview
- **Dashboard Grid** - Performance-focused cards:
  - Rating progression over time
  - Win rate trends
  - Performance by time control
  - Opening performance analysis
  - Trend indicators
  - Historical comparisons

**Data Integration:**
- Same data sources as Analysis Dashboard
- Focus on temporal trends and performance metrics
- Rating history calculations
- Performance comparisons across time periods

---

## Design System Integration

### Color Tokens
All components use semantic color tokens from the design system:
- `--fg-*` for foreground/text colors
- `--bg-*` for background colors
- `--accent-primary` for highlights
- Time class specific colors via CSS classes

### Typography
- `kol-heading-*` for titles (sm, md, lg, xl)
- `kol-mono-*` for metrics and labels (xxs, xs, sm)
- Consistent spacing and hierarchy

### Layout Patterns
- Responsive grid systems
- Card-based components with consistent padding (p-6)
- Border styling: `border border-fg-08`
- Rounded corners: `rounded` (4px)
- Gap spacing: `gap-6` between cards

---

## Data Architecture

### Current Implementation
All dashboards currently use chess data as reference implementation:
- **Source:** `@kol/chess-data` package
- **Helpers:** `chessHelpers.js` for parsing and formatting
- **Data Types:** Game manifest, monthly summaries, game metadata

### Future Extensibility
Components are designed to accept any data source:
- Replace `@kol/chess-data` with domain-specific package
- Update helper functions for new data format
- Component structure remains identical
- Only data mapping layer needs changes

---

## Navigation Structure

```
/workshop/analytics/
├── overview              → Dashboard selector + layout showcase
├── components            → Component library with all building blocks
└── dashboards/
    ├── analysis          → Comprehensive analysis dashboard
    └── performance       → Performance metrics dashboard
```

**Related Navigation:**
- `/workshop/chess/analysis` - Chess game viewer (board + controls)
- `/workshop/chess/components` - Chess-specific apparatus components

---

## Component Dependencies

### Shared Components
- `DesPage` - Standard workshop page header
- `DesCard` - Card wrapper component
- `DashboardGrid` - Responsive grid layout
- `GridCard` - Grid item wrapper

### Chess-Specific Dependencies
All dashboard cards currently in:
- `apps/web/src/components/workshop/chess/cards/`
- `apps/web/src/components/workshop/chess/charts/`
- `apps/web/src/components/workshop/chess/dashboards/`

### Data Dependencies
- `@kol/chess-data` - Chess game data package
- `chessHelpers.js` - Parsing and formatting utilities
- `chess.css` - Chess-specific styles (time class colors)

---

## Key Differences from Chess Section

### Chess Section (`/workshop/chess`)
- **Focus:** Game playback, board interaction, chess apparatus
- **Components:** ChessBoard, game controls, notation display, piece palettes
- **Use Case:** Playing/viewing games, analyzing positions

### Analytics Section (`/workshop/analytics`)
- **Focus:** Data visualization, metrics, statistical analysis
- **Components:** Charts, graphs, KPI cards, dashboards
- **Use Case:** Understanding patterns, trends, performance over time

**Shared Resource:** Both use `@kol/chess-data` but for different purposes
- Chess: Individual game PGN data for playback
- Analytics: Aggregate statistics and metadata for visualization

---

## Migration Notes

**Date:** 2025-11-12

**Files Migrated:**
1. `ChessDashboards.jsx` → `AnalyticsOverview.jsx`
2. `ChessComponents.jsx` → `AnalyticsComponents.jsx`
3. `ChessDashboardAnalysis.jsx` → `AnalyticsDashboardAnalysis.jsx`
4. `ChessDashboardPerformance.jsx` → `AnalyticsDashboardPerformance.jsx`

**Changes Made:**
- Function names updated to Analytics*
- Export statements updated
- Route paths changed from `/chess/dashboards/*` to `/analytics/dashboards/*`
- Page titles updated to "Analytics" from "Chess"

**Content:** All component logic, JSX, and data handling copied verbatim

**Old Files:** Removed from `apps/web/src/routes/workshop/Chess*.jsx`

---

## Future Enhancements

### Planned Improvements
1. Extract chess-specific components to generic wrappers
2. Create domain-agnostic data adapter pattern
3. Add font metrics dashboard implementation
4. Add project analytics dashboard implementation
5. Create reusable chart component library in `@kol/ui`
6. Document data mapping patterns for new domains

### Extensibility Considerations
- All cards should accept generic data props
- Color mappings should be configurable
- Time-based calculations should be abstracted
- Domain-specific helpers should be pluggable

---

## Related Documentation
- `5.1.2-chess-components-data-integration-plan.md` - Chess data integration details
- `3.0.0-design-system-components.md` - Component structure standards
- `2.1.0-design-system-colors.md` - Color token system
- `2.2.0-design-system-typography.md` - Typography scales
