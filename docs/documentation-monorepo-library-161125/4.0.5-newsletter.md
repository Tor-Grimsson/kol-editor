# 4.0.5 Newsletter Signup

## Overview

Simple newsletter signup system that collects email addresses and stores them in a local markdown file. Used in the HomeSignup section on the home page.

## Architecture

### Frontend Component

**Location**: `apps/web/src/components/sections/home/HomeSignup.jsx`

**Features**:
- Email input with state management
- Form submission handler
- Success/error status messages
- Scroll-triggered fade-in animations

**State**:
```jsx
const [email, setEmail] = useState('')
const [status, setStatus] = useState('') // 'success', 'error', or ''
```

**API Integration**:
```jsx
const handleSubmit = async (e) => {
  e.preventDefault()

  const response = await fetch('/api/newsletter', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      email,
      timestamp: new Date().toISOString()
    })
  })
}
```

### Backend API

**Location**: `/apps/web/server.js`

**Server Details**:
- Express.js server running on port 3001
- Single POST endpoint: `/api/newsletter`
- Validates email format (basic @ check)
- Appends to markdown file with timestamp

**Data Storage**:
- File: `/apps/web/newsletter-signups.md`
- Format: Markdown list with email and ISO timestamp
- File is created automatically on first signup
- Added to `.gitignore` to prevent commits

**Example Output**:
```markdown
# Newsletter Signups

- user@example.com - 2025-11-12T00:48:00.000Z
- another@email.com - 2025-11-12T01:23:45.678Z
```

## Configuration

### Vite Proxy

**Location**: `/apps/web/vite.config.js`

```js
server: {
  proxy: {
    '/api': {
      target: 'http://localhost:3001',
      changeOrigin: true
    }
  }
}
```

This proxies all `/api/*` requests from the Vite dev server (port 5173) to the Express API server (port 3001).

### Scripts

**Location**: `/apps/web/package.json`

```json
{
  "scripts": {
    "dev": "vite",
    "api": "node server.js"
  }
}
```

## Usage

### Running in Development

1. Start the Vite dev server:
```bash
cd apps/web && yarn dev
```

2. Start the API server (in a separate terminal):
```bash
cd apps/web && yarn api
```

### User Flow

1. User enters email address in the input field
2. User clicks "Subscribe" button
3. Frontend validates and sends POST request to `/api/newsletter`
4. Backend validates email and appends to markdown file
5. Success message displays: "Thanks for subscribing!"
6. Email input clears automatically

### Error Handling

**Frontend**:
- Empty email: Shows error message
- Failed request: Shows error message "Please enter a valid email address."

**Backend**:
- Invalid email (no @): Returns 400 status
- File write error: Returns 500 status and logs error to console

## Content

**Section Label**: Newsletter

**Heading**: Subscribe to our newsletter

**Description**: Get updates on new typefaces, design resources, and selected work delivered to your inbox.

**Button**: Subscribe

## Future Improvements

This is a basic implementation for collecting signups locally. Future enhancements could include:

- Integration with email service providers (Mailchimp, ConvertKit, Buttondown)
- Email validation service (verify email exists)
- Double opt-in confirmation emails
- CSV export functionality
- Admin dashboard to view signups
- Duplicate email prevention
- Rate limiting to prevent spam
- reCAPTCHA integration

## Technical Notes

- The markdown file is a temporary solution for MVP
- File is not suitable for production (no concurrency handling)
- Consider database storage for production use
- No authentication required for basic local logging
- Server needs to be running separately from Vite dev server
