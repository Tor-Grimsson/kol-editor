# Documentation Search and Refinements

**Date**: 2025-11-12
**Session Focus**: Icon fixes, card styling, header alignment, and search functionality

## Overview

This session focused on refining the documentation system with several key improvements:
- Fixed icon loading issues for `docs-*` prefixed icons
- Improved documentation card hover states
- Attempted backdrop blur for header (reverted to solid)
- Aligned "DOCUMENTATION" logo with main content column
- Implemented search functionality in header tabs
- Various CSS cleanup and refinements

## Changes Made

### 1. Icon Loading Issues

**Problem**: Icons with `docs-*` prefix (e.g., `docs-layout-01`, `docs-edit`, `docs-clipboard-1`) were not loading through the Icon component's `import.meta.glob`.

**Solution**: Replaced problematic icon names with working alternatives:
- `docs-layout-02` → `foundation` (Grid & Layout tab)
- `docs-edit` → `pen` (Open in editor button)
- `docs-clipboard-1` → `copy` (Copy repo path button)

**Files Modified**:
- `/apps/web/src/utils/docsTabBuilder.js`
- `/apps/web/src/routes/workshop/DocumentationReader.jsx`
- `/apps/web/src/routes/workshop/Documentations.jsx`

### 2. Documentation Card Styling

**Problem**: Documentation cards had broken hover state (invalid Tailwind class `hover:bg-fg-02/40`) causing only text to turn yellow.

**Solution**: Created `.docs-card` CSS class with proper hover behavior:

```css
.docs-card {
  display: block;
  padding: 16px;
  border-radius: 8px;
  border: 1px solid;
  border-color: color-mix(in srgb, var(--kol-surface-on-primary) 4%, transparent);
  background: transparent;
  transition: all 0.2s ease;
}

.docs-card:hover {
  border-color: color-mix(in srgb, var(--kol-surface-on-primary) 12%, transparent);
  background: color-mix(in srgb, var(--kol-surface-on-primary) 2%, transparent);
}

.docs-card:hover * {
  color: inherit;
}
```

**Files Modified**:
- `/packages/ui/css/docs.css`
- `/apps/web/src/routes/workshop/Documentations.jsx`

### 3. Backdrop Blur Attempt

**Attempted**: Semi-transparent header with backdrop blur for modern "frosted glass" effect.

**Issues Encountered**:
- Scrolling columns never passed behind the header (internal scroll containers)
- Background needed to be on scrolling elements, not static wrapper
- Complex layout made effect not work as intended

**Resolution**: Reverted to solid header background:

```css
.docs-page-header {
  background: var(--kol-surface-primary);
}
```

**Files Modified**:
- `/packages/ui/css/docs.css`
- `/apps/web/src/routes/workshop/DocumentationReader.jsx`
- `/apps/web/src/routes/workshop/Documentations.jsx`

### 4. Header Logo Alignment

**Goal**: Align "DOCUMENTATION" logo with the left edge of main content column (720px area) instead of sitting next to Kolkrabbi wordmark.

**Implementation**:

```jsx
<div className="flex items-center justify-between">
  {/* Left: Kolkrabbi (296px) */}
  <Link to="/" style={{ width: '296px' }}>
    <Wordmark className="h-6 w-auto" />
  </Link>

  {/* Center: Docs (aligned with main content) */}
  <Link to="/workshop/design-system/documentation"
        className="flex-1"
        style={{ paddingLeft: '32px' }}>
    <img src="/svg/docs-documentation.svg" alt="Docs" />
  </Link>

  {/* Right: Theme Toggle */}
  <ThemeToggleButton />
</div>
```

**Layout**:
- Kolkrabbi: 296px (matches left sidebar width)
- Gap: 32px padding
- Documentation: Aligns with main content start
- ThemeToggle: Right side

**Files Modified**:
- `/apps/web/src/components/workshop/docs/DocsPageHeader.jsx`

### 5. Search Functionality

**Initial Approach**: Search input in right sidebar above "On this page".

**User Request**: Move search to header tab row, styled like tabs, with results showing in sidebar.

**Final Implementation**:

#### Header Structure:
```jsx
<div className="docs-tabrow-items">
  {/* Tabs in flex container */}
  <div style={{ display: 'flex', gap: '24px', flex: 1 }}>
    {tabs.map((tab) => (
      <Link className="docs-tab">{tab.label}</Link>
    ))}
  </div>

  {/* Search in 240px container (matches TOC width) */}
  {onSearch && (
    <div className="w-60 flex justify-start" style={{ paddingLeft: '20px' }}>
      <div className="docs-tab-search-wrapper">
        <Icon name="search-16" size={14} />
        <input placeholder="Search..." />
      </div>
    </div>
  )}
</div>
```

#### Search Styling:
```css
.docs-tab-search-wrapper {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 8px 12px;
  border-radius: 4px;
  background: transparent;
  color: color-mix(in srgb, var(--kol-surface-on-primary) 60%, transparent);
  transition: all 0.2s ease;
}

.docs-tab-search-wrapper:focus-within {
  background: var(--kol-surface-secondary);
  color: color-mix(in srgb, var(--kol-surface-on-primary) 100%, transparent);
}

.docs-tab-search {
  font-family: var(--kol-font-family-mono);
  font-size: 13px;
  font-weight: 500;
  color: inherit;
  background: transparent;
  border: none;
  outline: none;
  width: 120px;
}
```

#### Search Behavior:
- **Default**: Shows search icon + "Search..." placeholder, transparent background
- **Focused**: Background switches to `surface-secondary`, text becomes opaque
- **Results**: Filter TOC headings, show count in sidebar ("3 results")

#### Component Updates:
```jsx
// DocumentationReader.jsx
const [searchQuery, setSearchQuery] = useState('')

const filteredToc = useMemo(() => {
  if (!searchQuery.trim()) return toc
  const query = searchQuery.toLowerCase()
  return toc.filter(item => item.heading.toLowerCase().includes(query))
}, [toc, searchQuery])

// Pass to header
<DocsPageHeader
  tabs={docTabs}
  onSearch={setSearchQuery}
  searchQuery={searchQuery}
/>

// Display in sidebar
{searchQuery.trim() ? (
  <>
    <p className="docs-sidebar-label">
      {filteredToc.length} {filteredToc.length === 1 ? 'result' : 'results'}
    </p>
    <DocsToc toc={filteredToc} />
  </>
) : (
  <>
    <p className="docs-sidebar-label">On this page</p>
    <DocsToc toc={toc} />
  </>
)}
```

**Files Modified**:
- `/apps/web/src/components/workshop/docs/DocsPageHeader.jsx`
- `/apps/web/src/routes/workshop/DocumentationReader.jsx`
- `/apps/web/src/routes/workshop/Documentations.jsx`
- `/packages/ui/css/docs.css`

### 6. CSS Cleanup

**Removed Dead Code**:
- `.docs-tabrow-wrapper` (not used anywhere)
- Redundant `padding-inline-start` on `.docs-list` (inherited from parent)

**Files Modified**:
- `/packages/ui/css/docs.css`

## Layout Specifications

### Header Layout
```
[Kolkrabbi (296px)] [32px gap] [DOCUMENTATION (flex-1)] [ThemeToggle]
[Typography][Color][Components][Grid & Layout][Icons][Patterns]... [Search (240px container)]
```

### Content Layout
```
max-w-[1400px], px-10 (40px), gap-8 (32px)

Columns:
- Nav: 296px (w-[296px])
- Main: 720px (w-[720px] pr-4)
- TOC: 240px (w-60)
```

### Search Alignment
- Search container: 240px (w-60) with 20px left padding
- Search wrapper: 12px padding, adds to 32px total offset
- Aligns perfectly with "ON THIS PAGE" content below

## Key Design Decisions

1. **Icon Names**: Avoided `docs-*` prefix for reliability with `import.meta.glob`
2. **Solid Header**: Backdrop blur not feasible with internal scroll containers
3. **Logo Alignment**: Documentation logo aligns with main content for visual consistency
4. **Search Position**: Header placement more discoverable than sidebar
5. **Search Scope**: Current page filtering (fast, simple) vs. global search (complex)

## Files Changed Summary

### New Files
None (all modifications to existing files)

### Modified Files
1. `/packages/ui/css/docs.css` - Card styling, search styling, cleanup
2. `/apps/web/src/components/workshop/docs/DocsPageHeader.jsx` - Logo alignment, search integration
3. `/apps/web/src/utils/docsTabBuilder.js` - Icon name updates
4. `/apps/web/src/routes/workshop/DocumentationReader.jsx` - Search state, filtered TOC
5. `/apps/web/src/routes/workshop/Documentations.jsx` - Search state, filtered TOC, card class

## Outcome

The documentation system now features:
- ✅ Fixed icon loading with reliable icon names
- ✅ Proper card hover states with subtle background changes
- ✅ Clean solid header (no blur complexity)
- ✅ Documentation logo aligned with main content
- ✅ Search in header, visually integrated with tabs
- ✅ Live search filtering of TOC headings
- ✅ Cleaner CSS with dead code removed
- ✅ Consistent alignment throughout the page

## Next Steps

### Search Enhancements
- Global search across all documentation pages
- Search keyboard shortcuts (⌘K / Ctrl+K)
- Search result highlighting in content
- Search history/recent searches
- Fix `docs-*` icon loading if needed for other features

### Visual Documentation Components
Implement interactive documentation elements to showcase design system foundations and components:

#### 1. Color System Documentation
- Color palette with swatches showing all tokens
- Display `--kol-surface-primary`, `--kol-accent-primary`, etc.
- Show color values (hex/RGB)
- Color contrast ratios for accessibility
- Light/dark mode side-by-side comparison

#### 2. Typography Scale Documentation
- All heading levels with actual rendered sizes (H1-H6)
- Font family showcase: RightGrotesk variants (Tight, Narrow, Compact), Inter, mono
- Line heights, letter spacing, font weights
- Integration with existing Interactive Type Tester

#### 3. Spacing/Layout System
- Visual grid demonstrations
- Gap values visualization (8px, 16px, 24px, 32px, etc.)
- Container widths and breakpoints (1400px max-width, etc.)
- Padding/margin system

#### 4. Component Library Documentation
- Live component previews embedded in docs
- Props documentation tables
- Code examples with copy functionality
- Usage guidelines and best practices
- Do's and don'ts with visual examples

#### 5. Interactive Examples
- Color picker/customizer
- Layout configurator
- Component playground with live editing
- Theme switcher preview
