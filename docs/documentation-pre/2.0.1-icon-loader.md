# 2.0.1 Icon Loader

## Overview

The Icon component (`src/components/icons/Icon.jsx`) uses Vite's `import.meta.glob` to dynamically load SVG files at runtime.

## Key Features

- **Zero bundle overhead**: SVGs are bundled by Vite but loaded on-demand
- **Automatic caching**: Loaded icons are cached in memory (persists until page reload)
- **Type-safe paths**: Icons must exist at build time (Vite validates the glob pattern)

## How It Works

### 1. Vite Import Glob

At build time, Vite processes:

```js
const iconModules = import.meta.glob('./svg/**/*.svg', { query: '?raw', import: 'default' })
```

This creates a registry of all SVG files as lazy-loaded modules:

```js
{
  './svg/a/anchor.svg': () => import('./svg/a/anchor.svg?raw'),
  './svg/t/trash.svg': () => import('./svg/t/trash.svg?raw'),
  // ... all other icons
}
```

The `?raw` query imports the SVG as a string (not as a URL).

### 2. Path Resolution

The component constructs the path from props:

```js
// User provides:
<Icon name="trash" />
// Resolves to: ./svg/t/trash.svg

// With custom folder:
<Icon name="rectangle" folder="tools-name/shape-align" />
// Resolves to: ./svg/tools-name/shape-align/rectangle.svg
```

**Default folder logic**: First letter of `name` prop (lowercase)

### 3. Async Loading & Caching

When rendering `<Icon name="trash" />`:

1. Component constructs path: `./svg/t/trash.svg`
2. Checks cache: `iconCache.has(path)`
3. If not cached, calls loader: `iconModules[path]()`
4. Vite dynamically imports the SVG string
5. Caches result in `iconCache` (a Map)
6. Renders via `dangerouslySetInnerHTML`

## Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `name` | `string` | **required** | Icon filename without `.svg` |
| `folder` | `string` | `name[0]` | Override folder path |
| `size` | `number` | `20` | Width and height in pixels |
| `color` | `string` | `'currentColor'` | SVG fill color |
| `className` | `string` | `''` | Additional CSS classes |
| `fallback` | `ReactNode` | `null` | Rendered if icon fails to load |
| `title` | `string` | `undefined` | Accessibility title |

## Usage Examples

```jsx
// Basic - auto-folder by first letter
<Icon name="star" size={24} />

// Custom folder
<Icon name="flip-x" folder="tools-name/shape-align" size={20} />

// Inherit parent color
<span className="text-blue-400">
  <Icon name="star" size={24} />
</span>

// With fallback
<Icon name="nonexistent" fallback={<span>?</span>} />

// Accessible
<Icon name="trash" size={16} title="Delete Item" />
```

## Adding New Icons

1. Place SVG in correct folder (by first letter or custom folder)
2. Ensure SVG uses `currentColor` for theming:
   ```xml
   <path fill="currentColor" d="..." />
   ```
3. Use immediately - no imports needed

## Folder Structure

```
src/components/icons/svg/
├── a/                          # First-letter folders
├── b/
├── c/
│   └── caret-down.svg
├── s/
│   └── star.svg
├── t/
│   └── trash.svg
├── a1/                         # Custom folders
│   └── photo-02.svg
└── tools-name/
    ├── other/
    │   ├── pointer-selector.svg
    │   ├── zoom-magnify.svg
    │   └── crop.svg
    └── shape-align/
        ├── rectangle.svg
        ├── circle.svg
        └── flip-x.svg
```

## Performance

- **First load**: ~5-10ms per icon (async import + DOM render)
- **Cached load**: <1ms (direct Map lookup)
- **Bundle impact**: ~200 bytes per icon (just the loader function)
